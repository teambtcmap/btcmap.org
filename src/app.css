@import 'tailwindcss';
@config '../tailwind.config.js';

@font-face {
	font-family: 'Manrope';
	src: url('/fonts/Manrope-Regular.ttf') format('truetype');
	font-display: swap;
}

@layer base {
	html {
		font-family: Manrope, sans-serif;
		@apply text-base;
	}

	::selection {
		@apply bg-[#53c5d5] text-white;
	}

	button {
		cursor: pointer;
	}

	button:disabled {
		cursor: not-allowed;
	}
}

@layer utilities {
	.sr-only {
		position: absolute !important;
		width: 1px !important;
		height: 1px !important;
		padding: 0 !important;
		margin: -1px !important;
		overflow: hidden !important;
		clip: rect(0, 0, 0, 0) !important;
		white-space: nowrap !important;
		border: 0 !important;
	}

	.gradient {
		background: -webkit-linear-gradient(45deg, #0ecd71, #040273);
		background-clip: text;
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
	}

	.gradient-bg {
		background: -webkit-linear-gradient(45deg, #0ecd71, #040273);
	}

	/* Hide scrollbar for Chrome, Safari and Opera */
	.hide-scroll::-webkit-scrollbar {
		@apply hidden;
	}

	/* Hide scrollbar for IE, Edge and Firefox */
	.hide-scroll {
		-ms-overflow-style: none; /* IE and Edge */
		scrollbar-width: none; /* Firefox */
	}

	.center {
		@apply absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2;
	}

	.center-fixed {
		@apply fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2;
	}

	/* Safe area insets for notched devices (iPhone X+) */
	.pt-safe {
		padding-top: env(safe-area-inset-top);
	}

	.pb-safe {
		padding-bottom: env(safe-area-inset-bottom);
	}
}

@layer components {
	.div-icon {
		background-image: url('/icons/div-icon-pin.svg');
	}

	.boosted-icon {
		background-image: url('/icons/boosted-icon-pin.svg');
	}

	/* Optimized marker styles for performance */
	.marker-normal,
	.marker-boosted {
		@apply relative flex items-center justify-center;
		width: 32px;
		height: 43px;
	}

	.marker-background {
		@apply flex h-8 w-8 items-center justify-center rounded-full;
		background: linear-gradient(135deg, #f97316 0%, #ea580c 100%);
		box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
	}

	.marker-boosted .marker-background {
		background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
		box-shadow: 0 2px 12px rgba(251, 191, 36, 0.5);
	}

	.marker-icon {
		@apply text-white;
		font-size: 20px;
		line-height: 1;
		margin-top: 2px;
	}

	.comment-badge {
		@apply absolute -top-1 -right-1 bg-green-600 text-xs font-bold text-white;
		@apply flex h-4 w-4 items-center justify-center rounded-full;
		transform: translate(50%, -50%);
		box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
	}

	/* Animation for boosted markers */
	@keyframes wiggle {
		0%,
		100% {
			transform: rotate(0deg);
		}
		25% {
			transform: rotate(-3deg);
		}
		75% {
			transform: rotate(3deg);
		}
	}

	.animate-wiggle {
		animation: wiggle 2s ease-in-out infinite;
	}

	/* Selected marker highlight */
	.selected-marker {
		filter: drop-shadow(0 0 4px #00b7d2) drop-shadow(0 0 8px #00b7d2) !important;
		animation: pulse-glow 2s ease-in-out infinite;
	}

	.selected-marker-boosted {
		filter: drop-shadow(0 0 4px #f7931a) drop-shadow(0 0 8px #f7931a) !important;
		animation: pulse-glow-boosted 2s ease-in-out infinite;
	}

	@keyframes pulse-glow {
		0%,
		100% {
			filter: drop-shadow(0 0 4px #00b7d2) drop-shadow(0 0 8px #00b7d2);
		}
		50% {
			filter: drop-shadow(0 0 6px #00b7d2) drop-shadow(0 0 12px #00b7d2);
		}
	}

	@keyframes pulse-glow-boosted {
		0%,
		100% {
			filter: drop-shadow(0 0 4px #f7931a) drop-shadow(0 0 8px #f7931a);
		}
		50% {
			filter: drop-shadow(0 0 6px #f7931a) drop-shadow(0 0 12px #f7931a);
		}
	}

	/* Fix for Leaflet controls not visible on mobile Firefox/Brave */
	/* Only apply to fullscreen map to avoid breaking embedded maps */
	.map-fullscreen .leaflet-bottom {
		position: fixed !important;
		bottom: 0 !important;
	}
}

/* Center icons in Leaflet control buttons */
.leaflet-bar a {
	display: flex;
	align-items: center;
	justify-content: center;
}

/* Invert custom button icons in dark mode */
.dark .leaflet-bar a img {
	filter: invert(1);
}

/* Dark mode for Leaflet controls - Tailwind gray palette */
.dark {
	--leaflet-bg: #1f2937; /* gray-800 */
	--leaflet-bg-transparent: rgba(31, 41, 55, 0.8);
	--leaflet-border: #374151; /* gray-700 */
	--leaflet-border-muted: #6b7280; /* gray-500 */
	--leaflet-text: #f3f4f6; /* gray-100 */
	--leaflet-text-muted: #9ca3af; /* gray-400 */
	--leaflet-link: #60a5fa; /* blue-400 */
}

.dark .leaflet-bar,
.dark .leaflet-control-layers {
	background-color: var(--leaflet-bg);
	border-color: var(--leaflet-border);
}

.dark .leaflet-bar a {
	color: var(--leaflet-text);
	background-color: var(--leaflet-bg);
	border-bottom-color: var(--leaflet-border);
}

.dark .leaflet-bar a:hover {
	background-color: var(--leaflet-border);
}

.dark .leaflet-control-layers-toggle {
	background-color: var(--leaflet-bg);
}

.dark .leaflet-control-layers-list {
	background-color: var(--leaflet-bg);
	color: var(--leaflet-text);
}

.dark .leaflet-control-attribution {
	background-color: var(--leaflet-bg-transparent);
	color: var(--leaflet-text-muted);
}

.dark .leaflet-control-attribution a {
	color: var(--leaflet-link);
}

.dark .leaflet-control-scale-line {
	background-color: var(--leaflet-bg-transparent);
	color: var(--leaflet-text);
	border-color: var(--leaflet-border-muted);
	text-shadow: none;
}

/* Dark mode for select dropdown options (Windows/Linux native rendering fix) */
.dark select option {
	background-color: rgb(55 65 81); /* gray-700 */
}

/* Marker label styles for Leaflet permanent tooltips */
.leaflet-tooltip.marker-label {
	background: none !important;
	color: #0d9488 !important; /* teal for standard markers */
	border: none !important;
	outline: none !important;
	box-shadow: none !important;
	font-size: 14px !important;
	padding: 2px 4px !important;
	margin: 0 !important;
	border-radius: 0 !important;
	text-align: left !important;
	white-space: nowrap !important;
	overflow: hidden !important;
	text-overflow: ellipsis !important;
	display: inline-block !important;
	max-width: 160px !important;
	min-width: unset !important;
	width: auto !important;
	height: auto !important;
	-webkit-font-weight: 500 !important;
	font-weight: 500 !important;
	line-height: 1.2 !important;
	text-shadow:
		-1px -1px 0 white,
		1px -1px 0 white,
		-1px 1px 0 white,
		1px 1px 0 white !important;
}

.dark .leaflet-tooltip.marker-label {
	text-shadow:
		-1px -1px 0 rgba(15, 23, 42, 0.9),
		1px -1px 0 rgba(15, 23, 42, 0.9),
		-1px 1px 0 rgba(15, 23, 42, 0.9),
		1px 1px 0 rgba(15, 23, 42, 0.9) !important;
}

.leaflet-tooltip.marker-label-boosted {
	color: #f59e0b !important; /* boosted amber */
	font-weight: 600 !important;
	text-shadow:
		-1px -1px 0 #fff7ed,
		1px -1px 0 #fff7ed,
		-1px 1px 0 #fff7ed,
		1px 1px 0 #fff7ed !important;
	filter: drop-shadow(0 1px 2px rgba(255, 193, 7, 0.35));
}

.dark .leaflet-tooltip.marker-label-boosted {
	color: #fbbf24 !important;
	text-shadow:
		-1px -1px 0 rgba(15, 23, 42, 0.9),
		1px -1px 0 rgba(15, 23, 42, 0.9),
		-1px 1px 0 rgba(15, 23, 42, 0.9),
		1px 1px 0 rgba(15, 23, 42, 0.9) !important;
	filter: drop-shadow(0 1px 3px rgba(250, 204, 21, 0.4));
}

/* Ensure tooltips stay behind markers without conflicting with cluster overlays */
.leaflet-map-pane .leaflet-tooltip-pane {
	z-index: 350 !important;
}

.leaflet-marker-icon,
.leaflet-marker-shadow {
	z-index: 400 !important;
}

/* Hide the tooltip arrow/pointer for permanent labels */
.leaflet-tooltip.marker-label::before,
.leaflet-tooltip-tip-container {
	display: none !important;
}
